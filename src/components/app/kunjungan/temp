<template>
  <div>
    <div class="baru-toolbar px-4 py-2">
      <span class="title">Data Kunjungan 
        <span v-if="baru">Baru</span>
        <span v-else>Member</span>
      </span>
      <v-btn
        color="primary"
        dark
        large
        @click="save"
      >
        <span class="mr-4">Simpan</span>
        <font-awesome-icon icon="download" size="lg"></font-awesome-icon>
      </v-btn>
    </div>
    <v-divider/>
    <v-toolbar dense color="white" flat>
      <v-toolbar-items>
        <v-btn v-for="it in navs" :key="it.to"
          flat
          :to="it.to">
          {{ it.text }}
        </v-btn>
      </v-toolbar-items>
    </v-toolbar>
    <v-divider/>
    <v-tabs id="kunjungan-tab" v-model="activeTab">
      <v-tab href="#pemilik">Pemilik</v-tab>
      <v-tab href="#pasien">Pasien</v-tab>
      <v-tab href="#rekammedik">Rekam Medik</v-tab>
      <v-tab href="#hasillab">Hasil Lab</v-tab>
      <v-tab href="#penkhusus">Penanganan Khusus</v-tab>
      <v-tab-item id="pemilik">
        <pemilik-baru v-if="baru" v-on:save="savePemilik"/>
        <simple-auto-complete v-else
          name="Pemilik" :f="fPemilik" v-on:save="savePemilik"/>
      </v-tab-item>
      <v-tab-item id="pasien">
        <pasien-baru v-if="baru" v-on:save="savePasien"/>
        <simple-auto-complete v-else
          name="Pasien" :f="fPasien" v-on:save="savePasien"/>
      </v-tab-item>
      <v-tab-item id="rekammedik">
        <rekam-medik v-on:save="saveRekamMedik"/>
      </v-tab-item>
      <v-tab-item id="hasillab">
        <hasil-lab v-on:save="saveHasilLab"/>
      </v-tab-item>
      <v-tab-item id="penkhusus">
        <pen-khusus/>
      </v-tab-item>
    </v-tabs>
  </div>
</template>

<script>
import PemilikBaru from './PemilikBaru'
import SimpleAutoComplete from './SimpleAutoComplete'
import PasienBaru from './PasienBaru'
import RekamMedik from './RekamMedik'
import HasilLab from './HasilLab'
import PenKhusus from './PenKhusus'
import defItem from './defItem'
import Service from '@/services'

export default {
  props: ['type'],
  components: {
    HasilLab,
    PenKhusus,
    SimpleAutoComplete,
    PemilikBaru,
    PasienBaru,
    RekamMedik
  },
  data () {
    return {
      currentStep: 1,
      item: defItem,
      activeTab: 'pemilik',
      fPemilik: Service.Pemilik.list,
      fPasien: Service.Pasien.list,
      navs: [
        {
          text: 'Pemilik',
          to: 'pemilik'
        },
        {
          text: 'Pasien',
          to: 'pasien'
        },
        {
          text: 'Rekam Medik',
          to: 'rekammedik'
        },
        {
          text: 'Hasil Lab',
          to: 'hasillab'
        },
        {
          text: 'Penanganan Khusus',
          to: 'penkhusus'
        }
      ]
    }
  },
  methods: {
    savePemilik (item) {
      this.item.pemilik = item
      this.activeTab = 'pasien'
    },
    savePasien (item) {
      this.item.pasien = item
      this.activeTab = 'rekammedik'
    },
    saveRekamMedik (item) {
      this.item.rekamMedik = item
      this.activeTab = 'hasillab'
    },
    saveHasilLab (item) {
      this.item.hasilLab = item
      this.activeTab = 'penkhusus'
    },
    savePenKhusus (item) {
      this.item.penKhusus = item
    },
    save () { this.$emit('save', this.item) }
  },
  computed: {
    baru () {
      return this.type === 'baru'
    }
  }
}
</script>

<style lang="scss">
#kunjungan-tab {
  .v-window__container {
    max-height: 70vh;
    overflow-y: auto;
  }
  .v-tabs__wrapper {
    padding-left: 24px;
    margin-top: 32px;
    margin-bottom: 32px;

    a.v-tabs__item {
      text-align: left;
    }
  }
}

.baru-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
</style>
